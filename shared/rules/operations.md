# 運用ルール

このドキュメントは、Marpスライド生成システムの日常的な運用ルールを定義します。

## デッキの作成と管理

### 新規デッキの作成

1. **フォルダ命名規則**
   - 形式: `decks/YYYYMMDD_タイトル/`
   - 例: `decks/20260112_sample/`
   - 日付は作成日または発表予定日を使用

2. **必須ファイル**
   - `input.md`: 入力用のMarkdownファイル
   - `deck.md`: 生成されたスライド（AIが生成）
   - `.images/`: デッキ固有の画像用ディレクトリ（必要に応じて作成）

3. **作成手順**
   ```bash
   mkdir -p decks/YYYYMMDD_タイトル/.images
   touch decks/YYYYMMDD_タイトル/input.md
   ```

## 共通資産の管理

### 画像管理

1. **共通画像**
   - 配置先: `shared/.images/`
   - 対象: ロゴ、背景、全デッキで使用する画像
   - 命名規則: 分かりやすい英数字（例: `logo.png`, `background.png`）

2. **デッキ固有画像**
   - 配置先: `decks/<deck>/.images/`
   - 対象: 特定のデッキでのみ使用する画像
   - 命名規則: コンテンツを表す名前（例: `diagram.png`, `chart-01.png`）

3. **画像の最適化**
   - 幅: 最大800px
   - フォーマット: PNG, JPG推奨
   - ファイルサイズ: 可能な限り圧縮

### テンプレート管理

1. **テンプレートの編集**
   - 対象ファイル: `shared/templates/default.md`
   - 変更時は全デッキに影響することに注意
   - カスタムテンプレートは別名で保存（例: `custom.md`）

2. **ルールの更新**
   - 対象ファイル: `shared/rules/slide.md`
   - スライド生成時の制約を定義
   - 変更時はチーム全体に周知

## Git管理

### コミット対象

**管理するファイル:**
- すべてのMarkdownファイル（`.md`）
- 画像ファイル（`.png`, `.jpg`など）
- テンプレートとルール
- 設定ファイル

**管理しないファイル:**
- PDFファイル（`.pdf`） - `.gitignore`で除外
- 一時ファイル（`.tmp`, `.bak`など）
- システムファイル（`.DS_Store`など）

### ブランチ戦略

1. **main/master**: 本番用の安定版
2. **feature/deck-name**: 新規デッキ作成時
3. **fix/issue-description**: 修正作業時

### コミットメッセージ

推奨フォーマット:
```
[種別] 簡潔な説明

詳細な説明（必要に応じて）
```

種別の例:
- `[ADD]`: 新規デッキ追加
- `[UPDATE]`: 既存デッキの更新
- `[FIX]`: 修正
- `[REFACTOR]`: リファクタリング
- `[DOCS]`: ドキュメント更新

## スライド生成ワークフロー

### 1. 入力ファイルの準備

```markdown
# decks/<deck>/input.md に内容を記述

- 見出しと本文を自然な形で記述
- 箇条書きや図表も自由に使用
- AIが適切にスライドに分割・整形
```

### 2. Claude Codeでの生成

1. `shared/rules/slide.md`を開く
2. `decks/<deck>/input.md`を開く
3. Claude Codeのチャットで以下を実行:
   ```
   @slide.md @input.md を元にスライド生成
   ```

### 3. 生成後の確認

- [ ] ルールに従っているか確認
  - 文字数制限
  - 行数制限
  - 画像の配置
- [ ] 画像パスが正しいか確認
- [ ] Marp for VS Codeでプレビュー

### 4. PDF出力

1. VS Codeでコマンドパレット（Cmd+Shift+P）を開く
2. 「Marp: Export slide deck」を選択
3. PDF形式を選択
4. `decks/<deck>/deck.pdf`として保存

## 画像参照のベストプラクティス

### 相対パスの使用

**共通画像を参照:**
```markdown
![Logo](../../shared/.images/logo.png)
<img src="../../shared/.images/background.png" width="600">
```

**デッキ固有画像を参照:**
```markdown
![Diagram](./.images/diagram.png)
<img src="./.images/chart.png" width="500">
```

### 画像サイズの指定

- 小さいアイコン: `width="100"` - `width="200"`
- 中サイズ画像: `width="300"` - `width="500"`
- 大きい画像: `width="600"` - `width="800"`

## トラブルシューティング

### よくある問題と解決方法

1. **画像が表示されない**
   - 相対パスが正しいか確認
   - 画像ファイルが正しい場所にあるか確認
   - ファイル名の大文字小文字を確認

2. **文字が切れる**
   - 1行あたり50文字以内に収める
   - 長い文章は複数行に分割

3. **スライドが多すぎる**
   - 内容を整理・統合
   - 1スライドあたりの情報量を増やす（制限内で）

4. **PDF生成でエラー**
   - Marp for VS Code拡張機能が有効か確認
   - Markdown構文にエラーがないか確認

## メンテナンス

### 定期的な確認事項

- [ ] 共通画像の整理（未使用画像の削除）
- [ ] 古いデッキの整理またはアーカイブ
- [ ] テンプレートの更新確認
- [ ] ドキュメントの更新

### アーカイブ

使用しなくなったデッキは以下のように管理:
```bash
mkdir -p archive/
mv decks/YYYYMMDD_old_deck archive/
```

## チーム運用

### 複数人での作業

1. **作業開始前**
   - 最新のmainブランチをpull
   - 新しいブランチを作成

2. **作業中**
   - 自分のデッキフォルダ内で作業
   - 共通資産の変更は慎重に

3. **作業完了後**
   - プルリクエストを作成
   - レビューを依頼
   - マージ後はブランチを削除

### レビューポイント

- [ ] ルールに準拠しているか
- [ ] 画像パスが正しいか
- [ ] 不要なファイルがコミットされていないか
- [ ] 共通資産への影響がないか

## セキュリティとプライバシー

### 注意事項

1. **機密情報の扱い**
   - 社外秘の情報は慎重に扱う
   - 必要に応じてプライベートリポジトリを使用

2. **画像の権利**
   - 使用権限のある画像のみ使用
   - 著作権に配慮

3. **個人情報**
   - 不要な個人情報は含めない
   - 公開前に確認

## まとめ

このルールを守ることで、効率的かつ一貫性のあるスライド管理が可能になります。不明点や改善提案があれば、チームで議論して更新してください。
